================================================================================
TEST EXECUTION REPORT
================================================================================

Start Time: 2026-01-01 10:44:20
End Time: 2026-01-01 10:50:34
Duration: 0:06:13.381580

TOTAL TESTS: 11
PASSED: 9
FAILED: 2
SKIPPED: 0

================================================================================
PASSED TESTS:
================================================================================
1. test_admin_users_can_navigate_to_dedicated_admin_portal_login_page
   File: .venv\Lib\site-packages\pytest_bdd\scenario.py
   Line: 295
   Duration: 41.55s

2. test_login_page_displays_email_and_password_fields
   File: .venv\Lib\site-packages\pytest_bdd\scenario.py
   Line: 295
   Duration: 40.48s

3. test_forgot_password_link_redirects_to_password_reset_flow
   File: .venv\Lib\site-packages\pytest_bdd\scenario.py
   Line: 295
   Duration: 29.48s

4. test_empty_email_field_shows_validation_error
   File: .venv\Lib\site-packages\pytest_bdd\scenario.py
   Line: 295
   Duration: 52.35s

5. test_invalid_email_format_shows_validation_error
   File: .venv\Lib\site-packages\pytest_bdd\scenario.py
   Line: 295
   Duration: 52.80s

6. test_admin_can_successfully_log_in
   File: .venv\Lib\site-packages\pytest_bdd\scenario.py
   Line: 295
   Duration: 64.43s

7. test_admin_lands_on_admin_panel_dashboard__firms_view_by_default
   File: .venv\Lib\site-packages\pytest_bdd\scenario.py
   Line: 295
   Duration: 5.28s

8. test_admin_can_access_firms_section_and_view_firms_list
   File: .venv\Lib\site-packages\pytest_bdd\scenario.py
   Line: 295
   Duration: 20.32s

9. test_admin_can_access_users_section_and_view_users_list_readonly
   File: .venv\Lib\site-packages\pytest_bdd\scenario.py
   Line: 295
   Duration: 20.29s

================================================================================
FAILED TESTS:
================================================================================
1. test_firms_list_displays_all_required_columns
   File: .venv\Lib\site-packages\pytest_bdd\scenario.py
   Line: 295
   Duration: 5.34s
   Error:
fixturefunc = <function step_verify_row_details at 0x0000023D64365A80>, request = <FixtureRequest for <Function test_firms_list_displays_all_required_columns>>
kwargs = {'context': <conftest.context.<locals>.Context object at 0x0000023D648CB020>, 'entity_type': 'firm'}

    def call_fixture_func(
        fixturefunc: _FixtureFunc[FixtureValue], request: FixtureRequest, kwargs
    ) -> FixtureValue:
        if inspect.isgeneratorfunction(fixturefunc):
            fixturefunc = cast(Callable[..., Generator[FixtureValue]], fixturefunc)
            generator = fixturefunc(**kwargs)
            try:
                fixture_result = next(generator)
            except StopIteration:
                raise ValueError(f"{request.fixturename} did not yield a value") from None
            finalizer = functools.partial(_teardown_yield_fixture, fixturefunc, generator)
            request.addfinalizer(finalizer)
        else:
            fixturefunc = cast(Callable[..., FixtureValue], fixturefunc)
>           fixture_result = fixturefunc(**kwargs)
                             ^^^^^^^^^^^^^^^^^^^^^

.venv\Lib\site-packages\_pytest\fixtures.py:915: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

context = <conftest.context.<locals>.Context object at 0x0000023D648CB020>, entity_type = 'firm', scenario = None

    @then(parsers.parse('each row should display these details'))
    @then(parsers.parse('each {entity_type} row should display these details'))
    def step_verify_row_details(context, entity_type=None, scenario=None):
        """
        Verify that each row in the table displays the expected details
        Generic step that works with any table - checks that rows have data in expected columns
    
        Args:
            context: Context fixture from conftest.py
            entity_type: Optional entity type (e.g., 'firm', 'user') - for readability only
            scenario: pytest-bdd scenario fixture (optional, for future table data)
        """
        entity_text = f"{entity_type} " if entity_type else ""
        print(f"   >> Verifying that each {entity_text}row displays expected details...")
    
        # Get expected columns from previous step or from context
        expected_columns = getattr(context, 'expected_columns', None)
        if not expected_columns:
            # Try to get from table summary
            summary = context.table_handler.get_table_summary()
            if summary:
                expected_columns = summary.get('headers', [])
                expected_columns = [h.strip() for h in expected_columns if h and h.strip()]
    
        if not expected_columns:
            raise AssertionError("No expected columns found. Make sure to verify columns first with 'I should see a table with the following columns'")
    
        # Read all rows from table
        rows = context.table_handler.read_all_rows()
        if not rows:
            raise AssertionError("Table has no data rows")
    
        print(f"   >> Checking {len(rows)} rows for {len(expected_columns)} expected columns...")
    
        # Verify each row has data in expected columns
        rows_with_missing_data = []
        for row_index, row in enumerate(rows):
            missing_data = []
            for col in expected_columns:
                # Find matching column in row (case-insensitive)
                row_value = None
                for key, value in row.items():
                    if col.strip().lower() == key.strip().lower():
                        row_value = value
                        break
                    # Try partial match
                    if col.strip().lower() in key.strip().lower() or key.strip().lower() in col.strip().lower():
                        row_value = value
                        break
    
                # Check if value exists and is not empty
                if not row_value or (isinstance(row_value, str) and not row_value.strip()):
                    missing_data.append(col)
    
            if missing_data:
                rows_with_missing_data.append({
                    'row_index': row_index,
                    'row_data': row,
                    'missing_columns': missing_data
                })
                print(f"   >> ✗ Row {row_index} missing data in: {missing_data}")
            else:
                print(f"   >> ✓ Row {row_index} has all expected data")
    
        if rows_with_missing_data:
            error_msg = f"Found {len(rows_with_missing_data)} row(s) with missing data:\n"
            for issue in rows_with_missing_data[:5]:  # Show first 5 issues
                error_msg += f"  Row {issue['row_index']}: missing {issue['missing_columns']}\n"
            if len(rows_with_missing_data) > 5:
                error_msg += f"  ... and {len(rows_with_missing_data) - 5} more\n"
>           raise AssertionError(error_msg)
E           AssertionError: Found 1 row(s) with missing data:
E             Row 0: missing ['Firm Name', 'Status', 'Email', 'Phone', 'Website', 'Date Created', 'Action']

steps\table_steps.py:449: AssertionError

2. test_admin_can_create_a_new_firm_with_owner
   File: .venv\Lib\site-packages\pytest_bdd\scenario.py
   Line: 295
   Duration: 38.42s
   Error:
fixturefunc = <function step_fill_all_mandatory_fields at 0x0000023D6418BC40>
request = <FixtureRequest for <Function test_admin_can_create_a_new_firm_with_owner>>
kwargs = {'context': <conftest.context.<locals>.Context object at 0x0000023D6490B290>}

    def call_fixture_func(
        fixturefunc: _FixtureFunc[FixtureValue], request: FixtureRequest, kwargs
    ) -> FixtureValue:
        if inspect.isgeneratorfunction(fixturefunc):
            fixturefunc = cast(Callable[..., Generator[FixtureValue]], fixturefunc)
            generator = fixturefunc(**kwargs)
            try:
                fixture_result = next(generator)
            except StopIteration:
                raise ValueError(f"{request.fixturename} did not yield a value") from None
            finalizer = functools.partial(_teardown_yield_fixture, fixturefunc, generator)
            request.addfinalizer(finalizer)
        else:
            fixturefunc = cast(Callable[..., FixtureValue], fixturefunc)
>           fixture_result = fixturefunc(**kwargs)
                             ^^^^^^^^^^^^^^^^^^^^^

.venv\Lib\site-packages\_pytest\fixtures.py:915: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
steps\maven_steps.py:2992: in step_fill_all_mandatory_fields
    current_url = context.driver.current_url
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\selenium\webdriver\remote\webdriver.py:542: in current_url
    return self.execute(Command.GET_CURRENT_URL)["value"]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\selenium\webdriver\remote\webdriver.py:432: in execute
    self.error_handler.check_response(response)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <selenium.webdriver.remote.errorhandler.ErrorHandler object at 0x0000023D643D4F50>
response = {'status': 404, 'value': '{"value":{"error":"invalid session id","message":"invalid session id","stacktrace":"Symbols ...ff675ec5de4\\n\\t0x7ff675eced8c\\n\\t0x7ff675c49cb8\\n\\t0x7ff67631f008\\n\\t0x7ffdc8107374\\n\\t0x7ffdc8efcc91\\n"}}'}

    def check_response(self, response: dict[str, Any]) -> None:
        """Check that a JSON response from the WebDriver does not have an error.
    
        Args:
            response: The JSON response from the WebDriver server as a dictionary
                object.
    
        Raises:
            WebDriverException: If the response contains an error message.
        """
        status = response.get("status", None)
        if not status or status == ErrorCode.SUCCESS:
            return
        value = None
        message = response.get("message", "")
        screen: str = response.get("screen", "")
        stacktrace = None
        if isinstance(status, int):
            value_json = response.get("value", None)
            if value_json and isinstance(value_json, str):
                try:
                    value = json.loads(value_json)
                    if isinstance(value, dict):
                        if len(value) == 1:
                            value = value["value"]
                        status = value.get("error", None)
                        if not status:
                            status = value.get("status", ErrorCode.UNKNOWN_ERROR)
                            message = value.get("value") or value.get("message")
                            if not isinstance(message, str):
                                value = message
                                message = message.get("message") if isinstance(message, dict) else None
                        else:
                            message = value.get("message", None)
                except ValueError:
                    pass
    
        exception_class: type[WebDriverException]
        e = ErrorCode()
        error_codes = [item for item in dir(e) if not item.startswith("__")]
        for error_code in error_codes:
            error_info = getattr(ErrorCode, error_code)
            if isinstance(error_info, list) and status in error_info:
                exception_class = getattr(ExceptionMapping, error_code, WebDriverException)
                break
        else:
            exception_class = WebDriverException
    
        if not value:
            value = response["value"]
        if isinstance(value, str):
            raise exception_class(value)
        if message == "" and "message" in value:
            message = value["message"]
    
        screen = None  # type: ignore[assignment]
        if "screen" in value:
            screen = value["screen"]
    
        stacktrace = None
        st_value = value.get("stackTrace") or value.get("stacktrace")
        if st_value:
            if isinstance(st_value, str):
                stacktrace = st_value.split("\n")
            else:
                stacktrace = []
                try:
                    for frame in st_value:
                        line = frame.get("lineNumber", "")
                        file = frame.get("fileName", "<anonymous>")
                        if line:
                            file = f"{file}:{line}"
                        meth = frame.get("methodName", "<anonymous>")
                        if "className" in frame:
                            meth = f"{frame['className']}.{meth}"
                        msg = "    at %s (%s)"
                        msg = msg % (meth, file)
                        stacktrace.append(msg)
                except TypeError:
                    pass
        if exception_class == UnexpectedAlertPresentException:
            alert_text = None
            if "data" in value:
                alert_text = value["data"].get("text")
            elif "alert" in value:
                alert_text = value["alert"].get("text")
            raise exception_class(message, screen, stacktrace, alert_text)  # type: ignore[call-arg]  # mypy is not smart enough here
>       raise exception_class(message, screen, stacktrace)
E       selenium.common.exceptions.InvalidSessionIdException: Message: invalid session id; For documentation on this error, please visit: https://www.selenium.dev/documentation/webdriver/troubleshooting/errors#invalidsessionidexception
E       Stacktrace:
E       Symbols not available. Dumping unresolved backtrace:
E       	0x7ff675ea88e5
E       	0x7ff675ea8940
E       	0x7ff675c81465
E       	0x7ff675cc9d83
E       	0x7ff675d01ee2
E       	0x7ff675cfc500
E       	0x7ff675cfb6f0
E       	0x7ff675c4b325
E       	0x7ff6761c0640
E       	0x7ff6761baf80
E       	0x7ff6761d96e6
E       	0x7ff675ec5de4
E       	0x7ff675eced8c
E       	0x7ff675c49cb8
E       	0x7ff67631f008
E       	0x7ffdc8107374
E       	0x7ffdc8efcc91

.venv\Lib\site-packages\selenium\webdriver\remote\errorhandler.py:232: InvalidSessionIdException

