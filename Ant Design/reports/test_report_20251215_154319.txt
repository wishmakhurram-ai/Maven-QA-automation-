================================================================================
TEST EXECUTION REPORT
================================================================================

Start Time: 2025-12-15 15:42:05
End Time: 2025-12-15 15:43:19
Duration: 0:01:13.823953

TOTAL TESTS: 1
PASSED: 0
FAILED: 1
SKIPPED: 0

================================================================================
FAILED TESTS:
================================================================================
1. test_firms_list_displays_all_required_columns
   File: .venv\Lib\site-packages\pytest_bdd\scenario.py
   Line: 295
   Duration: 71.22s
   Error:
fixturefunc = <function step_see_table_with_columns at 0x00000158F5DFC180>
request = <FixtureRequest for <Function test_firms_list_displays_all_required_columns>>
kwargs = {'context': <conftest.context.<locals>.Context object at 0x00000158F5EFCD40>}

    def call_fixture_func(
        fixturefunc: _FixtureFunc[FixtureValue], request: FixtureRequest, kwargs
    ) -> FixtureValue:
        if inspect.isgeneratorfunction(fixturefunc):
            fixturefunc = cast(Callable[..., Generator[FixtureValue]], fixturefunc)
            generator = fixturefunc(**kwargs)
            try:
                fixture_result = next(generator)
            except StopIteration:
                raise ValueError(f"{request.fixturename} did not yield a value") from None
            finalizer = functools.partial(_teardown_yield_fixture, fixturefunc, generator)
            request.addfinalizer(finalizer)
        else:
            fixturefunc = cast(Callable[..., FixtureValue], fixturefunc)
>           fixture_result = fixturefunc(**kwargs)
                             ^^^^^^^^^^^^^^^^^^^^^

.venv\Lib\site-packages\_pytest\fixtures.py:915: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

context = <conftest.context.<locals>.Context object at 0x00000158F5EFCD40>

    @then('I should see a table with the following columns:')
    def step_see_table_with_columns(context):
        """
        Verify table has specified columns from Gherkin table parameter
        Generic step that works with any table - uses table framework to identify columns
    
        Args:
            context: Context fixture from conftest.py
            scenario: pytest-bdd scenario fixture that contains the table data
        """
        print(f"   >> Verifying table columns...")
    
        # Get expected column names from Gherkin table
        expected_columns = []
    
        # Try to access pytest-bdd's internal 'table' object via frame locals
        # This is how we can read the scenario table without needing a 'table' fixture.
        import inspect
        try:
            frame = inspect.currentframe()
            caller = frame.f_back if frame else None
            if caller and 'table' in caller.f_locals:
                gherkin_table = caller.f_locals['table']
                if gherkin_table:
                    for row in gherkin_table:
                        if isinstance(row, dict):
                            if 'Column Name' in row:
                                value = row['Column Name']
                            elif row:
                                value = list(row.values())[0]
                            else:
                                value = None
                        else:
                            value = str(row)
    
                        if value:
                            expected_columns.append(str(value).strip())
        finally:
            # Avoid reference cycles
            try:
                del frame
                del caller
            except Exception:
                pass
    
        if not expected_columns:
>           raise AssertionError("No expected columns found in feature file table")
E           AssertionError: No expected columns found in feature file table

steps\table_steps.py:234: AssertionError

